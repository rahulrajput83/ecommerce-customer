import Navbar from '@/components/Navbar';
import Head from 'next/head';
import { useRouter } from 'next/router';
import React, { useEffect, useState } from 'react'

function paymentStatus() {
    const router = useRouter()
    const [paymentData, setPaymentData] = useState({})
    const [cart, setCart] = useState([])

    useEffect(() => {
        if (router.isReady) {
            const { payment_id, payment_request_id } = router.query;
            if(payment_id && payment_request_id) {
                fetch('/api/paymentStatus', {
                    method: 'POST',
                    body: JSON.stringify({
                        id: payment_id,
                        request: payment_request_id
                    })
                })
                    .then(res => res.json())
                    .then((res) => {
                        console.log(res)
                    })
                    .catch(() => {
                        console.log('err')
                    })
            }
        }
    }, [router.isReady])

    useEffect(() => {
        const localCart = JSON.parse(localStorage.getItem('cart')) || [];
        setCart(localCart)
    }, [])

    return (
        <>
            <Head>
                <title>Cart</title>
                <meta name="description" content="Generated by create next app" />
                <meta name="viewport" content="width=device-width, initial-scale=1" />
                <link rel="icon" href="favicon.ico" />
            </Head>

            <main className='w-full'>
                <Navbar cart={cart} />
                <main className='w-full flex flex-col md:flex-row box-border'>
                    <div className='mt-20 md:mt-16 px-2 md:px-16 pb-4 md:pb-10 w-full flex flex-col'>
                        <span>Checking Payment Status</span>
                    </div>
                </main>
            </main>
        </>
    )
}

export default paymentStatus